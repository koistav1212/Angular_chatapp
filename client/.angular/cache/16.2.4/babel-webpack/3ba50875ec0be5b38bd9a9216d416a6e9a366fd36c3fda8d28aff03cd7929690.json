{"ast":null,"code":"import _asyncToGenerator from \"C:/Games/my_Whatsapp_clone/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { EventEmitter } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/services\";\nimport * as i2 from \"@angular/fire/compat/auth\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/material/tabs\";\nfunction SidebarComponent_div_8_img_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 21);\n  }\n}\nfunction SidebarComponent_div_8_img_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 22);\n  }\n}\nfunction SidebarComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 11);\n    i0.ɵɵlistener(\"click\", function SidebarComponent_div_8_Template_div_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const conversation_r2 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.conversationClicked.emit(conversation_r2));\n    });\n    i0.ɵɵelementStart(1, \"div\", 12);\n    i0.ɵɵelement(2, \"img\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 14)(4, \"div\", 15)(5, \"div\", 16);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 17);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 18);\n    i0.ɵɵtemplate(10, SidebarComponent_div_8_img_10_Template, 1, 0, \"img\", 19);\n    i0.ɵɵtemplate(11, SidebarComponent_div_8_img_11_Template, 1, 0, \"img\", 20);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const conversation_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"src\", conversation_r2.members.reciverPic, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(conversation_r2.members.reciverName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(conversation_r2.time);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !conversation_r2.latestMessageRead);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", conversation_r2.latestMessageRead);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", conversation_r2.latestMessage, \" \");\n  }\n}\nfunction SidebarComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 23)(1, \"div\", 12);\n    i0.ɵɵelement(2, \"img\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 14)(4, \"div\", 15)(5, \"div\", 16);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function SidebarComponent_div_14_Template_button_click_7_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r9);\n      const user_r7 = restoredCtx.$implicit;\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.connect(user_r7._id, user_r7.userName, user_r7.userName));\n    });\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const user_r7 = ctx.$implicit;\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(user_r7.userName);\n  }\n}\nexport let SidebarComponent = /*#__PURE__*/(() => {\n  class SidebarComponent {\n    get filteredConversations() {\n      return this.conversations.filter(conversation => {\n        return conversation.name.toLowerCase().includes(this.searchText.toLowerCase()) || conversation.latestMessage.toLowerCase().includes(this.searchText.toLowerCase());\n      });\n    }\n    get filteredUsers() {\n      return this.allUsers.filter(conversation => {\n        return conversation.name.toLowerCase().includes(this.searchText.toLowerCase()) || conversation.latestMessage.toLowerCase().includes(this.searchText.toLowerCase());\n      });\n    }\n    constructor(services, afAuth) {\n      this.services = services;\n      this.afAuth = afAuth;\n      this.conversationClicked = new EventEmitter();\n      this.conversations = [];\n      this.allUsers = [];\n    }\n    ngOnInit() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        (yield _this.services.getCurrUser()).subscribe(res => {\n          console.log(res);\n          _this.services.setCurrUser(res.user);\n          _this.getAllUsers();\n          _this.getAllConversation();\n        });\n      })();\n    }\n    getAllUsers() {\n      this.services.getUsers().subscribe(res => {\n        console.log(res);\n        this.allUsers = res.userList;\n      });\n    }\n    getAllConversation() {\n      this.services.getAllConversation(this.services.currUser).subscribe(res => {\n        if (res) this.conversations = res;\n        console.log(this.conversations);\n      });\n    }\n    connect(userId, userName, userPic) {\n      console.log(this.services.currUser);\n      let prvConv = [];\n      if (this.services.currUser.conversations) prvConv = this.services.currUser.conversations;\n      let senderprvConnect = [];\n      if (this.services.currUser.connections) senderprvConnect = this.services.currUser.connections;\n      this.services.newConversation({\n        reciverId: userId,\n        senderId: this.services.currUser._id,\n        reciverName: userName,\n        reciverPic: userPic,\n        senderName: this.services.currUser.userName,\n        senderPic: this.services.currUser.userName,\n        timestamps: Date.now()\n      }).subscribe(res => {\n        console.log(res);\n        prvConv.push(res.converstion._id);\n        senderprvConnect.push(userId);\n        this.services.userUpdate({\n          conversations: prvConv,\n          connections: senderprvConnect\n        }, this.services.currUser._id).subscribe(res => {\n          console.log(res);\n          this.services.userUpdate({\n            conversations: prvConv,\n            connections: senderprvConnect\n          }, userId).subscribe(res => {\n            this.services.getCurrUser();\n            this.getAllConversation();\n          });\n        });\n      });\n    }\n    openModal() {\n      console.log(\"open modal\");\n    }\n    static #_ = this.ɵfac = function SidebarComponent_Factory(t) {\n      return new (t || SidebarComponent)(i0.ɵɵdirectiveInject(i1.services), i0.ɵɵdirectiveInject(i2.AngularFireAuth));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: SidebarComponent,\n      selectors: [[\"app-sidebar\"]],\n      outputs: {\n        conversationClicked: \"conversationClicked\"\n      },\n      decls: 16,\n      vars: 5,\n      consts: [[\"id\", \"sidebar\"], [\"id\", \"row1\"], [\"label\", \"Messages\"], [\"id\", \"searchBox\"], [\"width\", \"19\", \"src\", \"../../assets/images/searchIcon.svg\"], [\"type\", \"text\", \"placeholder\", \"Search or start the new chat\", 3, \"ngModel\", \"ngModelChange\"], [\"id\", \"sidebarContent\"], [\"class\", \"conversation\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [\"label\", \"Available Users\"], [\"class\", \"conversation\", 4, \"ngFor\", \"ngForOf\"], [\"label\", \"My Profile\"], [1, \"conversation\", 3, \"click\"], [1, \"picture\"], [3, \"src\"], [1, \"content\"], [1, \"conversationHeader\"], [1, \"name\"], [1, \"time\"], [1, \"message\"], [\"src\", \"../../assets/images/doubleTick.svg\", 4, \"ngIf\"], [\"src\", \"../../assets/images/doubleTickBlue.svg\", 4, \"ngIf\"], [\"src\", \"../../assets/images/doubleTick.svg\"], [\"src\", \"../../assets/images/doubleTickBlue.svg\"], [1, \"conversation\"], [\"src\", \"../../assets/images/noPic.svg\"], [3, \"click\"]],\n      template: function SidebarComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"mat-tab-group\")(3, \"mat-tab\", 2)(4, \"div\", 3);\n          i0.ɵɵelement(5, \"img\", 4);\n          i0.ɵɵelementStart(6, \"input\", 5);\n          i0.ɵɵlistener(\"ngModelChange\", function SidebarComponent_Template_input_ngModelChange_6_listener($event) {\n            return ctx.searchText = $event;\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(7, \"div\", 6);\n          i0.ɵɵtemplate(8, SidebarComponent_div_8_Template, 13, 6, \"div\", 7);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(9, \"mat-tab\", 8)(10, \"div\", 3);\n          i0.ɵɵelement(11, \"img\", 4);\n          i0.ɵɵelementStart(12, \"input\", 5);\n          i0.ɵɵlistener(\"ngModelChange\", function SidebarComponent_Template_input_ngModelChange_12_listener($event) {\n            return ctx.searchText = $event;\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(13, \"div\", 6);\n          i0.ɵɵtemplate(14, SidebarComponent_div_14_Template, 8, 1, \"div\", 9);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelement(15, \"mat-tab\", 10);\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"@.disabled\", true);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngModel\", ctx.searchText);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", !ctx.searchText ? ctx.conversations : ctx.filteredConversations);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngModel\", ctx.searchText);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", !ctx.searchText ? ctx.allUsers : ctx.filteredConversations);\n        }\n      },\n      dependencies: [i3.NgForOf, i3.NgIf, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgModel, i5.MatTab, i5.MatTabGroup],\n      styles: [\"#sidebar[_ngcontent-%COMP%]{width:100%;height:100%;border-right:1px solid #e1e4e5;display:flex;flex-direction:column}#sidebar[_ngcontent-%COMP%]   #row1[_ngcontent-%COMP%]{display:flex;flex-direction:column}#sidebar[_ngcontent-%COMP%]   #row1[_ngcontent-%COMP%]   #sidebarHeader[_ngcontent-%COMP%]{flex-basis:67px;background-color:#eee;display:flex;flex-direction:row;align-items:center;padding-left:20px;padding-right:20px;justify-content:space-between}#sidebar[_ngcontent-%COMP%]   #row1[_ngcontent-%COMP%]   #sidebarHeader[_ngcontent-%COMP%]   .avatarContainer[_ngcontent-%COMP%]{flex-basis:43px;height:43px}#sidebar[_ngcontent-%COMP%]   #row1[_ngcontent-%COMP%]   #sidebarHeader[_ngcontent-%COMP%]   .avatarContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%}#sidebar[_ngcontent-%COMP%]   #row1[_ngcontent-%COMP%]   #sidebarHeader[_ngcontent-%COMP%]   .actionsContainer[_ngcontent-%COMP%]{height:100%;width:110px;display:flex;align-items:center;justify-content:space-between}#sidebar[_ngcontent-%COMP%]   #row1[_ngcontent-%COMP%]   #searchBox[_ngcontent-%COMP%]{flex-basis:50px;background-color:#fbfbfb;border-bottom:1px solid #e1e4e5;display:flex;align-items:center;justify-content:center}#sidebar[_ngcontent-%COMP%]   #row1[_ngcontent-%COMP%]   #searchBox[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;left:30px}#sidebar[_ngcontent-%COMP%]   #row1[_ngcontent-%COMP%]   #searchBox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(90% - 60px);border:none;border-radius:20px;height:70%;padding-left:60px;color:#a4a4a4;outline:none;box-shadow:0 0 3px #efefef}#sidebar[_ngcontent-%COMP%]   #row1[_ngcontent-%COMP%]   #searchBox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#a4a4a4;font-weight:100}#sidebar[_ngcontent-%COMP%]   #noConversations[_ngcontent-%COMP%]{padding-top:30px;text-align:center;color:#b9b9b9;font-size:18px;font-weight:100}#sidebar[_ngcontent-%COMP%]   #sidebarContent[_ngcontent-%COMP%]{flex-grow:1;overflow:auto;background:white}#sidebar[_ngcontent-%COMP%]   #sidebarContent[_ngcontent-%COMP%]   .conversation[_ngcontent-%COMP%]{height:67px;display:flex;padding-right:5px;transition:all .4s ease-in-out;cursor:pointer}#sidebar[_ngcontent-%COMP%]   #sidebarContent[_ngcontent-%COMP%]   .conversation[_ngcontent-%COMP%]:hover{background-color:#cccccc0d}#sidebar[_ngcontent-%COMP%]   #sidebarContent[_ngcontent-%COMP%]   .conversation[_ngcontent-%COMP%]   .picture[_ngcontent-%COMP%]{flex-basis:73px;height:100%;display:flex;align-items:center;justify-content:center}#sidebar[_ngcontent-%COMP%]   #sidebarContent[_ngcontent-%COMP%]   .conversation[_ngcontent-%COMP%]   .picture[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;width:48px}#sidebar[_ngcontent-%COMP%]   #sidebarContent[_ngcontent-%COMP%]   .conversation[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{border-bottom:1px solid #f2f2f2;flex-grow:1;padding:13px 10px 13px 0}#sidebar[_ngcontent-%COMP%]   #sidebarContent[_ngcontent-%COMP%]   .conversation[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .conversationHeader[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around}#sidebar[_ngcontent-%COMP%]   #sidebarContent[_ngcontent-%COMP%]   .conversation[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .conversationHeader[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{color:#040404}#sidebar[_ngcontent-%COMP%]   #sidebarContent[_ngcontent-%COMP%]   .conversation[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .conversationHeader[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{color:#979797;font-size:13px;padding-top:2px}#sidebar[_ngcontent-%COMP%]   #sidebarContent[_ngcontent-%COMP%]   .conversation[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{color:#717171;font-size:13px;padding-top:5px;display:flex;align-items:center}#sidebar[_ngcontent-%COMP%]   #sidebarContent[_ngcontent-%COMP%]   .conversation[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:2px}.fab-button[_ngcontent-%COMP%]{position:absolute;bottom:20px;left:27%}\"]\n    });\n  }\n  return SidebarComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}